/mnt/etc/nixos/hardware-configuration.nix1) To perform set up of new laptop first do:
     PARTITION FORMATTING (see below)
2) Then run:
    sudo nixos-generate-config --root /mnt
            can ignore>> ERROR: not a btrfs filesystem: /mnt/boot
                as long as you see:
                    writing /mnt/etc/nixos/hardware-configuration.nix...
                    writing /mnt/etc/nixos/configuration.nix...

3) And then edit config file resulting from prior step:
    /mnt/etc/nixos/hardware-configuration.nix 
    Add:
            fileSystems."/" = {
              device = "/dev/disk/by-label/nixos-ssd";
              fsType = "ext4";
            };

            fileSystems."/boot" = {
              device = "/dev/disk/by-label/EFI_SSD";
              fsType = "vfat";
              options = [ "fmask=0022" "dmask=0022" ];
            };
4) Follow Secure note for setup of .ssh key for git repo, then pull nixos-config project

5) need to fill in how to nixos-install (?)

6) Post-install steps





PARTITION FORMATTING

nix-shell -p gptfdisk       #  make sure partitioning utility is installed

########  setup disk partitions (SSD)

export DISK="/dev/nvme0n1"

# Zap all old partitioning info on SSD
sudo sgdisk --zap-all "$DISK"

# Create EFI (512M) and root (remainder) partitions with GPT labels
sudo sgdisk -n 1:0:+512M -t 1:ef00 -c 1:"EFI_SSD" "$DISK"
sudo sgdisk -n 2:0:0     -t 2:8300 -c 2:"rootfs-ssd" "$DISK"

# Format partitions with filesystem labels
sudo mkfs.vfat -F 32 -n EFI_SSD "${DISK}p1"
sudo mkfs.ext4 -L nixos-ssd "${DISK}p2"

# Mount with label-based device paths

sudo mkdir -p /mnt
sudo mount /dev/disk/by-label/nixos-ssd /mnt
sudo mkdir -p /mnt/boot
sudo mount /dev/disk/by-label/EFI_SSD /mnt/boot


